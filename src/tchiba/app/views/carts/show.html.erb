<h1>Your Cart</h1>
<% if @cartitems.empty? || @notable %>
  <p>You have nothing in your cart!</p>
<% else %>
  <table>
    <tr>
      <th>Blend Name</th>
      <th>Quantity</th>
      <th>Gross Price</th>
      <th>Discount</th>
      <th>Shipping Cost</th>
      <th>Final Total</th>
      <th>Checkout?</th>
      <th>Remove?</th>
    </tr>
    <% @cartitems.each do |item| %>
      <% if item.order %>
        <%= nil %>
      <% else %>
        <tr>
          <th><%= link_to  item.blend.name, blend_path(item.blend) %></th>
          <th>
            <%= form_with model: item, url: cart_update_path(item), local: true do |f|%>
              <%= f.number_field :blend_quantity, min: 1 %>
              <%= f.submit 'Update' %>
            <% end %>
          </th>
          <th><%= item.gross_price %></th>
          <th><%= item.total_discount %></th>
          <th><%= item.blend.shipping_cost %></th>
          <th><%= item.total_amount %></th>
          <th><%= link_to  "Checkout this item?", orders_path(id: item.id), method: "POST" %></th>
          <th><%= link_to  "X", cart_remove_path(item), method: "POST",
                                                        data: { confirm: 'Are you sure?' } %>
        </tr>
      <% end %>
    <% end %>
  </table>
<% end %>